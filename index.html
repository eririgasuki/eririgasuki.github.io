<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">










<meta property="og:type" content="website">
<meta property="og:title" content="Blog for learning">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Blog for learning">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Blog for learning">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/">





  <title>Blog for learning</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Blog for learning</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/04/10/初识分布式系统/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/04/10/初识分布式系统/" itemprop="url">初识分布式系统</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-04-10T22:16:26+08:00">
                2020-04-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>分布式系统是一个古老而宽泛的话题，近年因“大数据”等概念的兴起，又焕发出了青春。</p>
<p>总的来说，<strong>分布式系统</strong>要做的任务就是把<strong>多台机器</strong>有机的组合，连接起来，让其<strong>协同完成</strong>同一件任务，可以是<strong>计算任务</strong>，也可以是<strong>存储任务</strong>。</p>
<p>分布式系统大概包括三大部分：</p>
<ol>
<li>分布式存储系统</li>
<li>分布式计算系统</li>
<li>分布式管理系统</li>
</ol>
<h2 id="分布式存储系统"><a href="#分布式存储系统" class="headerlink" title="分布式存储系统"></a>分布式存储系统</h2><p>分布式存储系统大概可以分为四个子方向：</p>
<ol>
<li>结构化存储</li>
<li>非结构化存储</li>
<li>半结构化存储</li>
<li>In-memory 存储</li>
</ol>
<h3 id="结构化存储-structured-storage-systems"><a href="#结构化存储-structured-storage-systems" class="headerlink" title="结构化存储(structured storage systems)"></a>结构化存储(structured storage systems)</h3><p>典型场景就是 <strong>事务处理系统</strong>或<strong>关系型数据库</strong>。
结构化存储系统强调的是：</p>
<ol>
<li>结构化的数据（例如关系表）。</li>
<li>强一致性（例如银行系统，电商系统等场景）。</li>
<li>随机访问（索引，增删改查，SQL语言）。</li>
</ol>
<p>然而，正是由于这些性质和限制，<strong>结构化存储系统</strong>的可<strong>扩展性</strong>通常<strong>不是很好</strong>，这在一定程度上限制了大数据环境下的表现。</p>
<h3 id="非结构化存储-no-structured-storage-systems"><a href="#非结构化存储-no-structured-storage-systems" class="headerlink" title="非结构化存储(no-structured storage systems)"></a>非结构化存储(no-structured storage systems)</h3><p>和结构化存储不同，<strong>非结构化存储</strong>强调的是<strong>高扩展性</strong>，典型的系统就是分布式系统。</p>
<p>Google在2013年推出的GFS(google file system)做出了里程碑的一步，其开源实现对应为HDFS.GFS的主要思想包括：</p>
<ol>
<li>用master来管理metadata。</li>
<li>文件使用64MB的chunks来存储，并且在多个server上保存多个副本。</li>
<li>自动容错，自动错误恢复。</li>
</ol>
<p>虽然分布式文件系统的可扩展性，吞吐率都非常好，但几乎<strong>无法支持随机访问(random access)操作</strong>，通常<strong>只能进行文件追加(append)操作</strong>。
这使得<strong>非结构化存储</strong>系统很<strong>难面对低延时，实时性较强的应用</strong>。</p>
<h3 id="半结构化存储-semi-structure-storage-systems"><a href="#半结构化存储-semi-structure-storage-systems" class="headerlink" title="半结构化存储(semi-structure storage systems)"></a>半结构化存储(semi-structure storage systems)</h3><p><strong>半结构化存储</strong>便是为了解决结非构化存储系统随机访问性能差的问题。NoSQL,Key-Value Store,对象存储等都属于半结构化存储研究的领域。
NoSQL系统既有分布式文件系统所具有的可扩展性，又有结构化存储系统的随机访问能力（例如随机update, read 操作），系统在<strong>设计时</strong>通常<strong>选择简单键值（K-V）进行存储</strong>，抛弃了传统RDBMS里复杂SQL查询以及ACID事务。这样做可以<strong>换取系统最大的限度的可扩展性和灵活性</strong>。</p>
<h3 id="In-memory存储"><a href="#In-memory存储" class="headerlink" title="In-memory存储"></a>In-memory存储</h3><p>随着业务的并发越来越高，存储系统对低延迟的要求也越来越高。<strong>In-memory存储</strong>顾名思义就是将<strong>数据存储在内存</strong>中, 从而获得读写的高性能。比较有名的系统包括memcahed，以及Redis。这些<strong>基于K-V键值系统</strong>的主要目的是为基于磁盘的存储系统<strong>做cache</strong>。</p>
<h3 id="NewSQL"><a href="#NewSQL" class="headerlink" title="NewSQL"></a>NewSQL</h3><p>在结构化存储中提到，单机RDBMS系统在可扩展性上面临着巨大的挑战，然而NoSQL不能很好的支持关系模型。那是不是有一种系统能兼备RDBMS的特性（例如：完整的SQL支持，ACID事务支持），又能像NoSQL系统那样具有强大的可扩展能力呢？</p>
<p>2012年Google在OSDI上发表的Spanner，以及2013年在SIGMOD发表的F1,让业界第一次看到了关系模型和NoSQL在超大规模数据中心上融合的可能性。
不过由于这些系统都太过于黑科技了，没有大公司支持应该是做不出来的。比如Spanner里用了原子钟这样的黑科技来解决时钟同步问题，打破光速传输的限制。在这里只能对google表示膜拜。</p>
<h2 id="分布式计算系统"><a href="#分布式计算系统" class="headerlink" title="分布式计算系统"></a>分布式计算系统</h2><p><strong>分布式计算</strong>最为<strong>核心</strong>的部分就是<strong>容错</strong>。由于硬件的老化，有可能会导致某台存储设备没有启动起来，某台机器的网卡坏了，甚至于计算运行过程中断电了，这些都是有可能的。然而最平凡发生的错误是计算进程被杀掉。</p>
<p>分布式计算系统大概分为如下几类：</p>
<ol>
<li>传统基于msg的系统</li>
<li>MapReduce-like系统</li>
<li>图计算系统</li>
<li>基于状态（state）的系统</li>
<li>Streaming系统</li>
</ol>
<h3 id="传统基于msg的系统"><a href="#传统基于msg的系统" class="headerlink" title="传统基于msg的系统"></a>传统基于msg的系统</h3><p>这类系统里比较有代表性的就是 MPI（message passing interface）。MPI除了提供消息传递接口之外，其框架还实现了资源管理和分配，以及调度的功能。除此之外，MPI在高性能计算里也被广泛使用，通常可以和Infiniband这样的高速网络无缝结合。</p>
<p>除了send和recv接口之外，MPI中另一个接口也值得注意，那就是AllReduce。使用AllReduce通常只需要在单机核心源码里加入AllReduce一行代码，就能完成并行化的功能。因为其底层消息传递使用了tree aggregation，尽可能的将计算分摊到每一个节点。</p>
<p>因为MPI不支持容错，所以很难扩展到大规模集群之上。</p>
<h3 id="MapReduce-like系统"><a href="#MapReduce-like系统" class="headerlink" title="MapReduce-like系统"></a>MapReduce-like系统</h3><p>这一类系统又叫作dataflow系统，其中以MapReduce(Hadoop)和Spark为代表。这一类系统的特点是将计算抽象成为high-level operator,例如像map，reduce，filter这样的函数式算子，然后将算子组合成DAG，然后由后端的调度引擎进行并行化调度。</p>
<p>MapReduce-like的编程风格和MPI截然相反。MapReduce对程序的结构有严格的约束——计算过程必须能在两个函数中描述：map和reduce；输入和输出数据都必须是一个一个的records；任务之间不能通信，整个计算过程中唯一的通信机会是map phase和reduce phase之间的shuffling phase，这是在框架控制下的，而不是应用代码控制的。因为有了严格的控制，系统框架在任何时候出错都可以从上一个状态恢复。</p>
<p>由于良好的扩展性，许多人都机器学习算法的并行化任务放在了这些平台之上。然而这些系统最大缺点有两点：</p>
<ol>
<li>这些系统所能支持的机器学习模型通常都不是很大。导致这个问题的主要原因是这系统在push back机器学习模型时都是粗粒度的把整个模型进行回传，导致了网络通信的瓶颈。</li>
<li>严格的BSP同步计算使得集群的效率变的很低。也就是说系统很容易受到straggle的影响。</li>
</ol>
<h3 id="图计算系统"><a href="#图计算系统" class="headerlink" title="图计算系统"></a>图计算系统</h3><p>图计算系统是分布式计算里另一个分支，这些系统都是把计算过程抽象成图，然后在不同节点分布式执行，例如PageRank这样的任务，很适合用图计算系统来表示。</p>
<p>最早成名的图计算系统当属Google的pregel，该系统采用BSP模型，计算以vectex为中心。
除了同步（BSP）图计算系统之外，异步图计算系统里的佼佼者当属GraphLab，该系统提出了GAS的编程模型。</p>
<h3 id="基于状态（state）的系统"><a href="#基于状态（state）的系统" class="headerlink" title="基于状态（state）的系统"></a>基于状态（state）的系统</h3><p>这一类系统主要包括2010年OSDI上推出的Piccolo,以及后来2012年nips上Google推出的dist belief再到后来被机器系学习领域广泛应用的Parameter Server架构。</p>
<p>ParameterServer这种state-centric模型则把机器学习的模型存储参数上升为主要组件，并且采用异步机制提升处理能力。它通过采用分布式的 memcached 作为存放参数的存储，这样就提供了有效的机制作用于不同worker节点同步模型参数。</p>
<h3 id="Streaming-系统"><a href="#Streaming-系统" class="headerlink" title="Streaming 系统"></a>Streaming 系统</h3><p>Streaming系统是为流式数据提供服务的。其中比较有名的系统包括Storm,SparkStreaming,Flink等等。</p>
<h2 id="分布式管理系统"><a href="#分布式管理系统" class="headerlink" title="分布式管理系统"></a>分布式管理系统</h2><p>暂无笔记。</p>
<h2 id="学习总结"><a href="#学习总结" class="headerlink" title="学习总结"></a>学习总结</h2><p>鉴于新冠肺炎疫情封城措施，在磊哥的建议下初识了分布式的广阔世界。希望以后有机会能根据公司的业务场景，去继续深挖学习其中一个方向，并在实战中做出成果。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/08/web性能优化的常见方法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/08/web性能优化的常见方法/" itemprop="url">web性能优化的常见方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-08T14:10:56+08:00">
                2019-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="web性能优化思路"><a href="#web性能优化思路" class="headerlink" title="web性能优化思路"></a>web性能优化思路</h1><p>首先理解页面加载过程，然后从中考虑可能的解决方向。</p>
<ol>
<li>缓存</li>
<li>DNS查询  — 减少DNS查询</li>
<li>建立TCP连接 — 连接复用（<code>keep-alive</code>）</li>
<li>发送HTTP请求 — 减小cookie — cache-control</li>
<li>接受响应 — Etag 304 — Gzip</li>
<li>接受完成</li>
<li>Doctype（html/xml)</li>
<li>逐行解析</li>
<li>解析到标签<ul>
<li>在页面中渲染标签 （IE）</li>
<li>等CSS解析完了再渲染标签 （chrome）</li>
</ul>
</li>
<li>解析到CSS<ul>
<li>下载CSS</li>
<li>继续解析看还有没有CSS</li>
<li>并行下载，串行解析（IE同时下载4个，chrome同时下载8个）</li>
</ul>
</li>
</ol>
<h2 id="使用-CDN"><a href="#使用-CDN" class="headerlink" title="使用 CDN"></a>使用 CDN</h2><h2 id="使用-Cache-Control"><a href="#使用-Cache-Control" class="headerlink" title="使用 Cache-Control"></a>使用 Cache-Control</h2><h2 id="使用-Etag"><a href="#使用-Etag" class="headerlink" title="使用 Etag"></a>使用 Etag</h2><h2 id="使用-Gzip"><a href="#使用-Gzip" class="headerlink" title="使用 Gzip"></a>使用 Gzip</h2><h2 id="合并文件（CSS、JS、图片）"><a href="#合并文件（CSS、JS、图片）" class="headerlink" title="合并文件（CSS、JS、图片）"></a>合并文件（CSS、JS、图片）</h2><h2 id="调整-CSS-和-JS-的位置"><a href="#调整-CSS-和-JS-的位置" class="headerlink" title="调整 CSS 和 JS 的位置"></a>调整 CSS 和 JS 的位置</h2><p>CSS放到head里，js放在body最底部。</p>
<h2 id="压缩图片的工具"><a href="#压缩图片的工具" class="headerlink" title="压缩图片的工具"></a>压缩图片的工具</h2><h2 id="增加域名以并行下载资源"><a href="#增加域名以并行下载资源" class="headerlink" title="增加域名以并行下载资源"></a>增加域名以并行下载资源</h2><h2 id="懒加载和预加载"><a href="#懒加载和预加载" class="headerlink" title="懒加载和预加载"></a>懒加载和预加载</h2><p>最开始只加载首屏内容，然后看情况预加载后面的内容。通过js监听<code>onscroll</code>来决定记载哪些内容。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/08/JavaScript中使用prototype和class实现继承的对比/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/08/JavaScript中使用prototype和class实现继承的对比/" itemprop="url">JavaScript中使用prototype和class实现继承的对比</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-08T14:09:34+08:00">
                2019-04-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="继承的两种写法"><a href="#继承的两种写法" class="headerlink" title="继承的两种写法"></a>继承的两种写法</h2><p>ES5写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">function Human(name)&#123;</span><br><span class="line">    this.name = name</span><br><span class="line">&#125;</span><br><span class="line">Human.prototype.run = function()&#123;</span><br><span class="line">    console.log(&quot;我叫&quot;+this.name+&quot;，我在跑&quot;)</span><br><span class="line">    return undefined</span><br><span class="line">&#125;</span><br><span class="line">function Man(name)&#123;</span><br><span class="line">    Human.call(this, name)</span><br><span class="line">    this.gender = &apos;男&apos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var f = function()&#123;&#125;</span><br><span class="line">f.prototype = Human.prototype</span><br><span class="line">Man.prototype = new f()</span><br><span class="line">//上面三行等价于Man.prototype.__proto__ = Human.prototype</span><br><span class="line">//但直接修改__proto__开销很高</span><br><span class="line"></span><br><span class="line">Man.prototype.fight = function()&#123;</span><br><span class="line">    console.log(&apos;糊你熊脸&apos;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ES6写法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class Human&#123;</span><br><span class="line">    constructor(name)&#123;</span><br><span class="line">        this.name = name</span><br><span class="line">    &#125;</span><br><span class="line">    run()&#123;</span><br><span class="line">        console.log(&quot;我叫&quot;+this.name+&quot;，我在跑&quot;)</span><br><span class="line">        return undefined</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Man extends Human&#123;</span><br><span class="line">    constructor(name)&#123;</span><br><span class="line">        super(name)</span><br><span class="line">        this.gender = &apos;男&apos;</span><br><span class="line">    &#125;</span><br><span class="line">    fight()&#123;</span><br><span class="line">        console.log(&apos;糊你熊脸&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="两种方法的对比"><a href="#两种方法的对比" class="headerlink" title="两种方法的对比"></a>两种方法的对比</h2><p>ES5更为直观，便于理解。
ES6语法糖写起来容易，但继承属性不方便，需要写成函数然后return属性值。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/04/《认同》读后感-说服他人认同你的想法/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/04/《认同》读后感-说服他人认同你的想法/" itemprop="url">《认同》读后感---说服他人认同你的变革计划</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-04T00:05:55+08:00">
                2019-04-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="《认同》内容精华"><a href="#《认同》内容精华" class="headerlink" title="《认同》内容精华"></a>《认同》内容精华</h1><h2 id="主要内容"><a href="#主要内容" class="headerlink" title="主要内容"></a>主要内容</h2><ul>
<li>本书介绍了赢得认同应当遵循的若干原则</li>
<li>归纳了反对派经常使用的抨击手法</li>
<li>详细分析了回应抨击手法的话术</li>
</ul>
<h2 id="核心观点"><a href="#核心观点" class="headerlink" title="核心观点"></a>核心观点</h2><ol>
<li>好计划不会自然而然的得到认同，你需要认清变革中的三方关系和博弈过程。</li>
<li>反对派不是你要说服的对象，甚至也不是阻挡变革的人，而是你的搭档、你的共谋。</li>
<li>你需要看穿反对派五花八门的说辞——————它们惯用的无非是四种抨击手法。</li>
<li>在你做出回应时，简洁有力的风格比长篇大论更有效。</li>
</ol>
<p><img src="https://i.loli.net/2019/04/04/5ca4dd551eb26.png" alt="1554308359644.png"></p>
<h2 id="赢得认同的四个原则"><a href="#赢得认同的四个原则" class="headerlink" title="赢得认同的四个原则"></a>赢得认同的四个原则</h2><ol>
<li>做好思想准备<blockquote>
<p>误区：人为好计划自然会赢得人们的认同，而拿大把的时间去构思计划，而疏于考虑如何获得支持。</p>
</blockquote>
</li>
<li>认清权力关系<blockquote>
<p>误区：公布计划反派浮出水面后，全力说服反对的人。事实上，由于利益、性格等方面他们不可能被说服技巧所动摇。实际工作中，大领导和广大同事处在第三方位置，认清变革中推动者、反对派和第三方的权力关系。注意到第三方的认同的重要性。</p>
</blockquote>
</li>
<li>借力吸引关注<blockquote>
<p>以开放的心态欢迎反对意见，以公开讨论的方式吸引关注。</p>
</blockquote>
</li>
<li>回应应简洁有力<blockquote>
<p>长篇大论不适合回应反对派抨击，不是针对某一个质疑做出深度辩护。争取缺少足够耐心深入复杂思考的，第三方认同，需要简短，符合常理。</p>
</blockquote>
</li>
</ol>
<h2 id="如何简洁有力的回应抨击"><a href="#如何简洁有力的回应抨击" class="headerlink" title="如何简洁有力的回应抨击"></a>如何简洁有力的回应抨击</h2><p>反派观点五花八门，实则万变不离其宗，实则可归纳为四种抨击手法。</p>
<h3 id="制造恐慌"><a href="#制造恐慌" class="headerlink" title="制造恐慌"></a>制造恐慌</h3><blockquote>
<p>大多数人面对变革，不确定性抱有谨慎的态度，反派利用这一点通常夸大其词，引爆他人的焦虑。</p>
<blockquote>
<p>典型说辞：“你的提议会留下许多无法解决的问题，这个问题怎么办，那个又怎么办”，比如“如果美国限枪，那么接下来，明天限制买酒，后天限制买车，然后限制恋爱自由，直到最后完全控制我们的生活。”</p>
</blockquote>
</blockquote>
<p>回应方式：</p>
<ul>
<li>总结对方的思维方式，在逻辑上因果依据不充足。</li>
<li>借力打力，列举更为荒谬的例子。</li>
</ul>
<h3 id="无限拖延"><a href="#无限拖延" class="headerlink" title="无限拖延"></a>无限拖延</h3><ol>
<li>他们会说你的问题不重要。</li>
</ol>
<p>这时需要证明问题的紧迫性，拖下去只会让局面更糟。</p>
<ol start="2">
<li>批评你的方案不够深入。</li>
</ol>
<ul>
<li>你的方案本来很完善，却被对方故意简化，忽略重点，片面概括。</li>
<li>拿”条件不成熟”作为理由：”没有足够预算，缺乏相关经验，其他工作紧迫”。背后逻辑只有一条：”条件不完美，所以不行动”</li>
</ul>
<p>说清被简化的观点并非本意，承认问题的难度，并强调解决之后产生的价值。
说明确实有不足的地方，同时列举已经具备的条件，筹备计划中的条件，或者针对不足的措施等。引导人们看到积极的方面。</p>
<h3 id="混淆视听"><a href="#混淆视听" class="headerlink" title="混淆视听"></a>混淆视听</h3><p>反对者讲一些貌似很深奥、很复杂的道理，让人搞不清你的计划到底是咋回事。
你需要用通俗易懂的方式赶紧澄清。</p>
<ol>
<li>反派将你的计划总结为”先有鸡还是先有蛋”的问题，理由是计划包含了A、B两个部分，只要B不做，A就没法做，反过来也一样。
问题举例：<blockquote>
<p>教授想在学校开一门新课，而只有足够的学生选修这门课，这门课学校才允许开。但不开课，你就不在选修目录上，又怎么知道有多少人报名呢？</p>
</blockquote>
</li>
</ol>
<p>实际上，你可以先开小型研讨会，根据研讨会上学生的反馈积累经验，把研讨会的质量做的更扎实，多开几次，吸引更多学生参与。研讨会规模达到一定程度后，就有足够的理由申请把研讨会升级为正式课程，这就是把AB两个部分同时推进的方式。</p>
<ol start="2">
<li>反派使用极端的，夸张的语言，让他人觉得你的计划不合理。</li>
</ol>
<blockquote>
<p>你计划提到了，要买的那种设备非常便宜，后来又说这种设备要十分耐用。但是耐用的东西一定会花更多钱。那到底是非常便宜还是十分耐用呢？不可能两样都占吧。</p>
</blockquote>
<p>实际上，并没有要求设备既要非常便宜又要十分耐用，而只是价格在我们接受的范围内，同时设备质量可以达到行业平均水平，这两种要求可以同时满足。</p>
<h3 id="人身攻击"><a href="#人身攻击" class="headerlink" title="人身攻击"></a>人身攻击</h3><p>反对者歪曲你做事的动机，诱发人们的不满和怀疑。</p>
<ul>
<li>你的计划违背了企业长期以来的价值观。</li>
<li>你的计划是在职责其他员工没有早点解决这个问题吗？</li>
</ul>
<p>你是为了成事，为了创造价值，而他们是为了坏事，捣乱、搞破坏。如果你把自己降到跟他们同样的层次，以暴制暴，以牙还牙的时候，人们会觉得你不具备做成事的能力和胸怀。甚至反过来同情抨击你的人。
所以面对人身攻击要保持风度，这样才能在别人心中占领道德制高点。
然后，要表达你对第三方的重视和诚意，表示计划恰恰是坚持企业价值观，并真诚感激其他员工的辛勤劳动打下的基石，才会出现创造更大价值的机会。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/27/节流与防抖/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/27/节流与防抖/" itemprop="url">节流与防抖</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-27T22:08:01+08:00">
                2019-03-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="节流与防抖的概念"><a href="#节流与防抖的概念" class="headerlink" title="节流与防抖的概念"></a>节流与防抖的概念</h1><p><strong>函数节流（throttle）</strong></p>
<blockquote>
<p>预先设定一个执行周期，当调用动作的时刻大于等于执行周期则执行该动作，然后进入下一个新周期</p>
</blockquote>
<p><strong>函数防抖（debounce）</strong></p>
<blockquote>
<p>当调用动作过n毫秒后，才会执行该动作，若在这n毫秒内又调用此动作则将重新计算执行时间</p>
</blockquote>
<p><strong>函数节流（throttle）</strong>与 <strong>函数防抖（debounce）</strong>都是为了限制函数的执行频次，以优化函数触发频率过高导致的响应速度跟不上触发频率，出现延迟，假死或卡顿的现象。</p>
<h1 id="节流与防抖的应用"><a href="#节流与防抖的应用" class="headerlink" title="节流与防抖的应用"></a>节流与防抖的应用</h1><p>常见于如下状况:</p>
<blockquote>
<ul>
<li>window对象的resize、scroll事件</li>
<li>拖拽时的mousemove事件</li>
<li>文字输入、自动完成的keyup事件</li>
</ul>
</blockquote>
<h2 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h2><p><code>scroll</code>事件在文档或文档元素滚动时触发，主要出现在用户拖动滚动条。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&apos;scroll&apos;, callback);</span><br></pre></td></tr></table></figure></p>
<p>该事件会连续地大量触发，所以它的监听函数之中不应该有非常耗费计算的操作。推荐的做法是使用<code>requestAnimationFrame</code>或<code>setTimeout</code>控制该事件的触发频率，然后可以结合<code>customEvent</code>抛出一个新事件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(function () &#123;</span><br><span class="line">  var throttle = function (type, name, obj) &#123;</span><br><span class="line">    var obj = obj || window;</span><br><span class="line">    var running = false;</span><br><span class="line">    var func = function () &#123;</span><br><span class="line">      if (running) &#123; return; &#125;</span><br><span class="line">      running = true;</span><br><span class="line">      requestAnimationFrame(function() &#123;</span><br><span class="line">        obj.dispatchEvent(new CustomEvent(name));</span><br><span class="line">        running = false;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line">    obj.addEventListener(type, func);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  // 将 scroll 事件重定义为 optimizedScroll 事件</span><br><span class="line">  throttle(&apos;scroll&apos;, &apos;optimizedScroll&apos;);</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">window.addEventListener(&apos;optimizedScroll&apos;, function() &#123;</span><br><span class="line">  console.log(&apos;Resource conscious scroll callback!&apos;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>上面代码中，<code>throttle</code>函数用于控制事件触发频率，<code>requestAnimationFrame</code>方法保证每次页面重绘（每秒60次），只会触发一次<code>scroll</code>事件的监听函数。也就是说，上面方法将<code>scroll</code>事件的触发频率，限制在每秒60次。具体来说，就是<code>scroll</code>事件只要频率低于每秒60次，就会触发<code>optimizedScroll</code>事件，从而执行<code>optimizedScroll</code>事件的监听函数。</p>
<p>改用<code>setTimeout</code>方法，可以放置更大的时间间隔。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(function() &#123;</span><br><span class="line">  window.addEventListener(&apos;scroll&apos;, scrollThrottler, false);</span><br><span class="line"></span><br><span class="line">  var scrollTimeout;</span><br><span class="line">  function scrollThrottler() &#123;</span><br><span class="line">    if (!scrollTimeout) &#123;</span><br><span class="line">      scrollTimeout = setTimeout(function () &#123;</span><br><span class="line">        scrollTimeout = null;</span><br><span class="line">        actualScrollHandler();</span><br><span class="line">      &#125;, 66);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  function actualScrollHandler() &#123;</span><br><span class="line">    // ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;());</span><br></pre></td></tr></table></figure>
<p>上面代码中，每次<code>scroll</code>事件都会执行<code>scrollThrottler</code>函数。该函数里面有一个定时器<code>setTimeout</code>，每66毫秒触发一次（每秒15次）真正执行的任务<code>actualScrollHandler</code>。</p>
<p>下面是一个更一般的<code>throttle</code>函数的写法,<code>scroll</code>事件的触发频率，限制在一秒一次。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function throttle(fn, wait) &#123;</span><br><span class="line">  var time = Date.now();</span><br><span class="line">  return function() &#123;</span><br><span class="line">    if ((time + wait - Date.now()) &lt; 0) &#123;</span><br><span class="line">      fn();</span><br><span class="line">      time = Date.now();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.addEventListener(&apos;scroll&apos;, throttle(callback, 1000));</span><br></pre></td></tr></table></figure>
<h2 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h2><p>有时，我们不希望回调函数被频繁调用。比如，用户填入网页输入框的内容，希望通过 Ajax 方法传回服务器，jQuery 的写法如下。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;textarea&apos;).on(&apos;keydown&apos;, ajaxAction);</span><br></pre></td></tr></table></figure></p>
<p>这样写有一个很大的缺点，就是如果用户连续击键，就会连续触发<code>keydown</code>事件，造成大量的 Ajax 通信。这是不必要的，而且很可能产生性能问题。正确的做法应该是，设置一个门槛值，表示两次 Ajax 通信的最小间隔时间。如果在间隔时间内，发生新的<code>keydown</code>事件，则不触发 Ajax 通信，并且重新开始计时。如果过了指定时间，没有发生新的<code>keydown</code>事件，再将数据发送出去。</p>
<p>这种做法叫做<code>debounce</code>（防抖动）。假定两次 Ajax 通信的间隔不得小于2500毫秒，上面的代码可以改写成下面这样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$(&apos;textarea&apos;).on(&apos;keydown&apos;, debounce(ajaxAction, 2500));</span><br><span class="line"></span><br><span class="line">function debounce(fn, delay)&#123;</span><br><span class="line">  var timer = null; // 声明计时器</span><br><span class="line">  return function() &#123;</span><br><span class="line">    var context = this;</span><br><span class="line">    var args = arguments;</span><br><span class="line">    clearTimeout(timer);</span><br><span class="line">    timer = setTimeout(function () &#123;</span><br><span class="line">      fn.apply(context, args);</span><br><span class="line">    &#125;, delay);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码中，只要在2500毫秒之内，用户再次击键，就会取消上一次的定时器，然后再新建一个定时器。这样就保证了回调函数之间的调用间隔，至少是2500毫秒。</p>
<h1 id="通过lodash使用节流函数和防抖函数"><a href="#通过lodash使用节流函数和防抖函数" class="headerlink" title="通过lodash使用节流函数和防抖函数"></a>通过lodash使用节流函数和防抖函数</h1><h2 id="throttle-func-wait-0-options"><a href="#throttle-func-wait-0-options" class="headerlink" title="_.throttle(func, [wait=0], [options={}])"></a><code>_.throttle(func, [wait=0], [options={}])</code></h2><p>创建一个节流函数，在 wait 秒内最多执行 func 一次的函数。 该函数提供一个 cancel 方法取消延迟的函数调用以及 flush 方法立即调用。 可以提供一个 options 对象决定如何调用 func 方法， options.leading 与|或 options.trailing 决定 wait 前后如何触发。 func 会传入最后一次传入的参数给这个函数。 随后调用的函数返回是最后一次 func 调用的结果。 </p>
<p>参数</p>
<ul>
<li><code>func (Function)</code>: 要节流的函数。</li>
<li><code>[wait=0] (number)</code>: 需要节流的毫秒。</li>
<li><code>[options={}] (Object)</code>: 选项对象。</li>
<li><code>[options.leading=true] (boolean)</code>: 指定调用在节流开始前。</li>
<li><code>[options.trailing=true] (boolean)</code>: 指定调用在节流结束后。</li>
</ul>
<p>返回</p>
<ul>
<li><code>(Function)</code>: 返回节流的函数。</li>
</ul>
<p>例子
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 避免在滚动时过分的更新定位</span><br><span class="line">jQuery(window).on(&apos;scroll&apos;, _.throttle(updatePosition, 100));</span><br><span class="line"> </span><br><span class="line">// 点击后就调用 `renewToken`，但5分钟内超过1次。</span><br><span class="line">var throttled = _.throttle(renewToken, 300000, &#123; &apos;trailing&apos;: false &#125;);</span><br><span class="line">jQuery(element).on(&apos;click&apos;, throttled);</span><br><span class="line"> </span><br><span class="line">// 取消一个 trailing 的节流调用。</span><br><span class="line">jQuery(window).on(&apos;popstate&apos;, throttled.cancel);</span><br></pre></td></tr></table></figure></p>
<h2 id="debounce-func-wait-0-options"><a href="#debounce-func-wait-0-options" class="headerlink" title="_.debounce(func, [wait=0], [options={}])"></a><code>_.debounce(func, [wait=0], [options={}])</code></h2><p>创建一个 debounced（防抖动）函数，该函数会从上一次被调用后，延迟 wait 毫秒后调用 func 方法。 debounced（防抖动）函数提供一个 cancel 方法取消延迟的函数调用以及 flush 方法立即调用。 可以提供一个 options（选项） 对象决定如何调用 func 方法，options.leading 与|或 options.trailing 决定延迟前后如何触发（愚人码头注：是 先调用后等待 还是 先等待后调用）。 func 调用时会传入最后一次提供给 debounced（防抖动）函数 的参数。 后续调用的 debounced（防抖动）函数返回是最后一次 func 调用的结果。 </p>
<p>参数</p>
<ul>
<li><code>func (Function)</code>: 要防抖动的函数。</li>
<li><code>[wait=0] (number)</code>: 需要延迟的毫秒数。</li>
<li><code>[options={}] (Object)</code>: 选项对象。</li>
<li><code>[options.leading=false] (boolean)</code>: 指定在延迟开始前调用。</li>
<li><code>[options.maxWait] (number)</code>: 设置 func 允许被延迟的最大值。</li>
<li><code>[options.trailing=true] (boolean)</code>: 指定在延迟结束后调用。</li>
</ul>
<p>返回</p>
<ul>
<li><code>(Function)</code>: 返回新的 debounced（防抖动）函数</li>
</ul>
<p>例子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 避免窗口在变动时出现昂贵的计算开销。</span><br><span class="line">jQuery(window).on(&apos;resize&apos;, _.debounce(calculateLayout, 150));</span><br><span class="line"> </span><br><span class="line">// 当点击时 `sendMail` 随后就被调用。</span><br><span class="line">jQuery(element).on(&apos;click&apos;, _.debounce(sendMail, 300, &#123;</span><br><span class="line">  &apos;leading&apos;: true,</span><br><span class="line">  &apos;trailing&apos;: false</span><br><span class="line">&#125;));</span><br><span class="line"> </span><br><span class="line">// 确保 `batchLog` 调用1次之后，1秒内会被触发。</span><br><span class="line">var debounced = _.debounce(batchLog, 250, &#123; &apos;maxWait&apos;: 1000 &#125;);</span><br><span class="line">var source = new EventSource(&apos;/stream&apos;);</span><br><span class="line">jQuery(source).on(&apos;message&apos;, debounced);</span><br><span class="line"> </span><br><span class="line">// 取消一个 trailing 的防抖动调用</span><br><span class="line">jQuery(window).on(&apos;popstate&apos;, debounced.cancel);</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/04/Reflow和Repaint对前端性能的影响/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/04/Reflow和Repaint对前端性能的影响/" itemprop="url">Reflow和Repaint对前端性能的影响</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-04T16:14:35+08:00">
                2019-03-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Reflow和Repaint是什么？"><a href="#Reflow和Repaint是什么？" class="headerlink" title="Reflow和Repaint是什么？"></a>Reflow和Repaint是什么？</h1><p><strong>Repaint</strong> 就是“重绘”，它会在你改变 DOM 元素的视觉效果时进行，改变布局时不会触发。比如，<code>opacity,background-color,visibility</code>和<code>outline</code>等都会触发，“重绘”的开销还是比较昂贵的，因为浏览器会在某一个DOM元素的视觉效果改变后去check这个DOM元素内的所有节点。</p>
<p><strong>Reflow</strong> 就是“回流”，它的影响更大。它会在某一个DOM元素的位置发生改变后触发，而且它会重新计算所有元素的位置和在页面中的占有的面积，这样的话将会引起页面某一个部分甚至整个页面的重新渲染。改变某一个元素会影响它所有的子节点 (children)、祖先节点 (ancestors) 及兄弟节点(siblings)。</p>
<p>浏览器的对待页面是<strong>先布局后渲染</strong>,在PC端Reflow和Repaint对于性能的影响是微乎其微，但是在<strong>移动端</strong>这俩货简直就是<strong>性能杀手</strong>。</p>
<p>repaint和reflow是DOM操作影响性能的主要原因。一个节点触发了repaint，浏览器会检查DOM Tree中其他所有节点的显示方式；一个节点触发了reflow会导致它的祖先节点，后代节点以及在它之后的节点全部reflow。<strong>reflow对性能的影响大于repaint</strong>。</p>
<p>什么情况下会触发Reflow？</p>
<p><strong> 添加、删除或者改变DOM元素的可见性时：使用JS去改变DOM元素时会触发Reflow。
</strong> 添加、删除或者改变CSS样式：直接改变CSS Style或者元素的class可能会影响布局，还有改变一个元素的宽度能够影响它所在的DOM节点中的所有元素，以及它周围的那些元素。
<strong> CSS3 动画（<code>animation</code>）和过渡（<code>transition</code>）: 动画的每一frame都会触发Reflow。
</strong> 使用<code>offsetWidth</code>和<code>offsetHeight</code>：这一点很特别，你读一个DOM的offsetWidth和offsetHeight属性同样会触发一下Reflow，因为这两个属性需要依赖一些元素去计算。
** 用户交互：用户可以通过<code>:hover</code>一下<code>&lt;a&gt;</code>链接，在input里面输入文字，拖动浏览器的大小，改变字体大小，更换样式表或者字体等都会触发reflow。</p>
<h1 id="如何提高性能？"><a href="#如何提高性能？" class="headerlink" title="如何提高性能？"></a>如何提高性能？</h1><p>一些常用的提高性能的原则</p>
<table>
    <thead>
        <tr>
            <th style="width: 24%">方面</th>
            <th>方法</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>布局</td>
            <td>不要用 inline style 或 table 布局，flexbox 布局也会给性能带来一些小困扰。inline style 会在 html下载完后进行一次额外的 Reflow，table布局的开销远比其他 DOM 元素的布局开销要大。flexbox 的 item 会在HTML 下载完成后改变尺寸。</td>
        </tr>
        <tr>
            <td>简写CSS</td>
            <td>尽量简写CSS，避免使用复杂的CSS选择器，使用 Unused CSS <a href="https://unused-css.com/）" target="_blank" rel="noopener">https://unused-css.com/）</a>, uCSS（https:/github.com/oyvindeh/ucss）, gulp-uncss（<a href="https://github.com/ben-eb/gulp-uncss）可以有效的减少样式定义和文件的大小。" target="_blank" rel="noopener">https://github.com/ben-eb/gulp-uncss）可以有效的减少样式定义和文件的大小。</a></td>
        </tr>
        <tr>
            <td>优化DOM</td>
            <td>减少DOM的层级，减少DOM的数量，如果不需适配老浏览器，删掉一些无用的wrapper性质的DOM元素，总之越少好。</td>
        </tr>
        <tr>
            <td>慎改class</td>
            <td>在一个DOM树中，尽可能改那些没有特别多子元素DOM的class，子元素少的可以改，多的不推荐。</td>
        </tr>
        <tr>
            <td>避免复杂动画</td>
            <td>删掉复杂的动画，运用动画的元素尽量是position:absolute或position:fixed的，这样会让他们脱离文档流不去影响其他的元素。</td>
        </tr>
        <tr>
            <td>善用display:none</td>
            <td>display:none的元素不会引发Reflow和Repaint，可以在让这些元素在display之前进行一些诸如颜色、尺寸么的改变。</td>
        </tr>
        <tr>
            <td>批量更新元素</td>
            <td>将状态写入一个类中，用JQ直接给元素添加或删除这个类，而不是直接通过方法来修改元素样式状态。</td>
        </tr>
        <tr>
            <td>避免大量DOM互相影响</td>
            <td>比如Tabs这种场景，如果你点击一个Tab会显示它控制的区块，显示的那个区块会影响其他的区块，这样可能会起Reflow，因为它们的高度不一样，可以通过定个高度来优化这种场景。</td>
        </tr>
        <tr>
            <td>性能永远比酷炫重要</td>
            <td>记住一个原则，你网页的动画再牛逼，性能还是第一位的，如果每一帧移动1个像素会造成你的页面卡顿，那宁愿一帧移动10像素让动画的帧变得迟钝一些，也不要让页面的性能降下来。</td>
        </tr>
    </tbody>
</table>

<p><a href="https://juejin.im/entry/595b5c135188250d7767f7d3" target="_blank" rel="noopener">参考链接</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/07/Cookie与登录注册/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/07/Cookie与登录注册/" itemprop="url">Cookie与登录注册</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-07T23:22:08+08:00">
                2019-02-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Cookie-的特点"><a href="#Cookie-的特点" class="headerlink" title="Cookie 的特点"></a>Cookie 的特点</h1><ol>
<li>服务器通过 Set-Cookie 响应头设置 Cookie</li>
<li>浏览器得到 Cookie 之后，每次请求都要带上 Cookie</li>
<li>服务器读取 Cookie 就知道登录用户的信息（email）</li>
</ol>
<h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><ol>
<li><p>我在 Chrome 登录了得到 Cookie，用 Safari 访问，Safari 会带上 Cookie 吗
no</p>
</li>
<li><p>Cookie 存在哪
Windows 存在 C 盘的一个文件里</p>
</li>
<li><p>Cookie会被用户篡改吗？
Session 可以解决这个问题，防止用户篡改</p>
</li>
<li><p>Cookie 有效期吗？
默认有效期20分钟左右，不同浏览器策略不同
后端可以强制设置有效期</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">设置过期时间:</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt; Expires //用于定义在哪个时间过期</span><br><span class="line">Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt; max-age //用于定义在多久之后会过期</span><br><span class="line">删除cookie:</span><br><span class="line">docCookies.removeItem(name[, path],domain)</span><br></pre></td></tr></table></figure>
</li>
<li><p>Cookie 遵守同源策略吗？
也有，不过跟 AJAX 的同源策略稍微有些不同。
当请求 qq.com 下的资源时，浏览器会默认带上 qq.com 对应的 Cookie，不会带上 baidu.com 对应的 Cookie
当请求 v.qq.com 下的资源时，浏览器不仅会带上 v.qq.com 的Cookie，还会带上 qq.com 的 Cookie</p>
</li>
</ol>
<h1 id="Session-与-Cookie-的关系"><a href="#Session-与-Cookie-的关系" class="headerlink" title="Session 与 Cookie 的关系"></a>Session 与 Cookie 的关系</h1><p>一般来说，Session 基于 Cookie 来实现。</p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3><ol>
<li>服务器通过 Set-Cookie 头给客户端一串字符串</li>
<li>客户端每次访问相同域名的网页时，必须带上这段字符串</li>
<li>客户端要在一段时间内保存这个Cookie</li>
<li>Cookie 默认在用户关闭页面后就失效，后台代码可以任意设置 Cookie 的过期时间</li>
<li>大小大概在 4kb 以内</li>
</ol>
<h3 id="Session"><a href="#Session" class="headerlink" title="Session"></a>Session</h3><ol>
<li>将 SessionID（随机数）通过 Cookie 发给客户端</li>
<li>客户端访问服务器时，服务器读取 SessionID</li>
<li>服务器有一块内存（哈希表）保存了所有 session</li>
<li>通过 SessionID 我们可以得到对应用户的隐私信息，如 id、email</li>
<li>这块内存（哈希表）就是服务器上的所有 session</li>
</ol>
<h3 id="LocalStorage"><a href="#LocalStorage" class="headerlink" title="LocalStorage"></a>LocalStorage</h3><ol>
<li>LocalStorage 跟 HTTP 无关</li>
<li>HTTP 不会带上 LocalStorage 的值</li>
<li>只有相同域名的页面才能互相读取 LocalStorage（没有同源那么严格）</li>
<li>每个域名 localStorage 最大存储量为 5Mb 左右（每个浏览器不一样）</li>
<li>常用场景：记录有没有提示过用户（没有用的信息，不能记录密码）</li>
<li>LocalStorage 永久有效，除非用户清理缓存</li>
</ol>
<h3 id="SessionStorage（会话存储）"><a href="#SessionStorage（会话存储）" class="headerlink" title="SessionStorage（会话存储）"></a>SessionStorage（会话存储）</h3><p>1、2、3、4 同上</p>
<ol start="5">
<li>SessionStorage 在用户关闭页面（会话结束）后就失效。</li>
</ol>
<h2 id="Cookie-和-Session-的区别"><a href="#Cookie-和-Session-的区别" class="headerlink" title="Cookie 和 Session 的区别"></a>Cookie 和 Session 的区别</h2><p>Cookie 保存在客户端，每次都随请求发送给 Server
Session 保存在 Server 的内存里，其 Session ID 是通过 Cookie 发送给客户端的</p>
<h2 id="Cookie-和-LocalStorage-的区别"><a href="#Cookie-和-LocalStorage-的区别" class="headerlink" title="Cookie 和 LocalStorage 的区别"></a>Cookie 和 LocalStorage 的区别</h2><p>LocalStorage 不会随 HTTP 发给 Server
LocalStorage 的大小限制比 Cookie 大多了</p>
<h2 id="LocalStorage-和-SessionStorage-的区别"><a href="#LocalStorage-和-SessionStorage-的区别" class="headerlink" title="LocalStorage 和 SessionStorage 的区别"></a>LocalStorage 和 SessionStorage 的区别</h2><p>一个不会自动过期，一个会自动过期。</p>
<h2 id="Cache-Control-max-age-1000-缓存-与-ETag-的「缓存」有什么区别？"><a href="#Cache-Control-max-age-1000-缓存-与-ETag-的「缓存」有什么区别？" class="headerlink" title="Cache-Control: max-age=1000 缓存 与 ETag 的「缓存」有什么区别？"></a>Cache-Control: max-age=1000 缓存 与 ETag 的「缓存」有什么区别？</h2><p>Cache-Control 直接不发请求。
而 ETag 要发请求才行。</p>
<hr>
<h1 id="登录注册"><a href="#登录注册" class="headerlink" title="登录注册"></a>登录注册</h1><h2 id="服务端代码server-js"><a href="#服务端代码server-js" class="headerlink" title="服务端代码server.js"></a>服务端代码server.js</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">var fs = require(&apos;fs&apos;)</span><br><span class="line">var url = require(&apos;url&apos;)</span><br><span class="line">var port = process.argv[2]</span><br><span class="line"></span><br><span class="line">if(!port)&#123;</span><br><span class="line">  console.log(&apos;请指定端口号\nnode server.js 8888 这样&apos;)</span><br><span class="line">  process.exit(1)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var server = http.createServer(function(request, response)&#123;</span><br><span class="line">  var parsedUrl = url.parse(request.url, true)</span><br><span class="line">  var pathWithQuery = request.url </span><br><span class="line">  var queryString = &apos;&apos;</span><br><span class="line">  if(pathWithQuery.indexOf(&apos;?&apos;) &gt;= 0)&#123; queryString = pathWithQuery.substring(pathWithQuery.indexOf(&apos;?&apos;)) &#125;</span><br><span class="line">  var path = parsedUrl.pathname</span><br><span class="line">  var query = parsedUrl.query</span><br><span class="line">  var method = request.method</span><br><span class="line"></span><br><span class="line">  /******** 从这里开始看，上面不要看 ************/</span><br><span class="line"></span><br><span class="line">  console.log(&apos;含查询字符串的路径\n&apos; + pathWithQuery)</span><br><span class="line"></span><br><span class="line">  if(path === &apos;/&apos;)&#123;</span><br><span class="line">    let string = fs.readFileSync(&apos;./index.html&apos;, &apos;utf8&apos;)</span><br><span class="line">    let cookies =  request.headers.cookie.split(&apos;; &apos;) // [&apos;email=1@&apos;, &apos;a=1&apos;, &apos;b=2&apos;]</span><br><span class="line">    let hash = &#123;&#125; //将cookie存放到一个hash表中</span><br><span class="line">    for(let i =0;i&lt;cookies.length; i++)&#123;</span><br><span class="line">      let parts = cookies[i].split(&apos;=&apos;)</span><br><span class="line">      let key = parts[0]</span><br><span class="line">      let value = parts[1]</span><br><span class="line">      hash[key] = value </span><br><span class="line">    &#125;</span><br><span class="line">    let email = hash.sign_in_email</span><br><span class="line">    let users = fs.readFileSync(&apos;./db/users&apos;, &apos;utf8&apos;)</span><br><span class="line">    users = JSON.parse(users)</span><br><span class="line">    let foundUser //确认服务器是否有此用户信息</span><br><span class="line">    for(let i=0; i&lt; users.length; i++)&#123;</span><br><span class="line">      if(users[i].email === email)&#123;</span><br><span class="line">        foundUser = users[i]</span><br><span class="line">        break</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    console.log(foundUser)</span><br><span class="line">    if(foundUser)&#123;</span><br><span class="line">      string = string.replace(&apos;__password__&apos;, foundUser.password)</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">      string = string.replace(&apos;__password__&apos;, &apos;不知道&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">    response.statusCode = 200</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/html;charset=utf-8&apos;)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;else if(path === &apos;/sign_up&apos; &amp;&amp; method === &apos;GET&apos;)&#123;  //路由sign_up的逻辑</span><br><span class="line">    let string = fs.readFileSync(&apos;./sign_up.html&apos;, &apos;utf8&apos;)</span><br><span class="line">    response.statusCode = 200</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/html;charset=utf-8&apos;)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;else if(path === &apos;/sign_up&apos; &amp;&amp; method === &apos;POST&apos;)&#123;</span><br><span class="line">    readBody(request).then((body)=&gt;&#123;</span><br><span class="line">      let strings = body.split(&apos;&amp;&apos;) // [&apos;email=1&apos;, &apos;password=2&apos;, &apos;password_confirmation=3&apos;]</span><br><span class="line">      let hash = &#123;&#125; //将用户提交的信息存到一个hash表里</span><br><span class="line">      strings.forEach((string)=&gt;&#123;</span><br><span class="line">        // string == &apos;email=1&apos;</span><br><span class="line">        let parts = string.split(&apos;=&apos;) // [&apos;email&apos;, &apos;1&apos;]</span><br><span class="line">        let key = parts[0]</span><br><span class="line">        let value = parts[1]</span><br><span class="line">        hash[key] = decodeURIComponent(value) // hash[&apos;email&apos;] = &apos;1&apos;</span><br><span class="line">      &#125;)</span><br><span class="line">      let &#123;email, password, password_confirmation&#125; = hash</span><br><span class="line">      if(email.indexOf(&apos;@&apos;) === -1)&#123; //如果用户填写的邮箱地址不含有@</span><br><span class="line">        response.statusCode = 400</span><br><span class="line">        response.setHeader(&apos;Content-Type&apos;, &apos;application/json;charset=utf-8&apos;)</span><br><span class="line">        response.write(`&#123;</span><br><span class="line">          &quot;errors&quot;: &#123;</span><br><span class="line">            &quot;email&quot;: &quot;invalid&quot;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;`)</span><br><span class="line">      &#125;else if(password !== password_confirmation)&#123;</span><br><span class="line">        response.statusCode = 400</span><br><span class="line">        response.write(&apos;password not match&apos;)</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        var users = fs.readFileSync(&apos;./db/users&apos;, &apos;utf8&apos;)</span><br><span class="line">        try&#123;</span><br><span class="line">          users = JSON.parse(users) // []</span><br><span class="line">        &#125;catch(exception)&#123;</span><br><span class="line">          users = []  //如果解析本地db文件失败则设置为空数组</span><br><span class="line">        &#125;</span><br><span class="line">        let inUse = false //确定本地是否有相同账户邮箱名</span><br><span class="line">        for(let i=0; i&lt;users.length; i++)&#123;</span><br><span class="line">          let user = users[i]</span><br><span class="line">          if(user.email === email)&#123;</span><br><span class="line">            inUse = true</span><br><span class="line">            break;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(inUse)&#123;</span><br><span class="line">          response.statusCode = 400</span><br><span class="line">          response.write(&apos;email in use&apos;)</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">          users.push(&#123;email: email, password: password&#125;)</span><br><span class="line">          var usersString = JSON.stringify(users)</span><br><span class="line">          fs.writeFileSync(&apos;./db/users&apos;, usersString)</span><br><span class="line">          response.statusCode = 200</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      response.end()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;else if(path===&apos;/sign_in&apos; &amp;&amp; method === &apos;GET&apos;)&#123; //sign_in逻辑与sign_up类似</span><br><span class="line">    let string = fs.readFileSync(&apos;./sign_in.html&apos;, &apos;utf8&apos;)</span><br><span class="line">    response.statusCode = 200</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/html;charset=utf-8&apos;)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;else if(path===&apos;/sign_in&apos; &amp;&amp; method === &apos;POST&apos;)&#123;</span><br><span class="line">    readBody(request).then((body)=&gt;&#123;</span><br><span class="line">      let strings = body.split(&apos;&amp;&apos;) // [&apos;email=1&apos;, &apos;password=2&apos;, &apos;password_confirmation=3&apos;]</span><br><span class="line">      let hash = &#123;&#125;</span><br><span class="line">      strings.forEach((string)=&gt;&#123;</span><br><span class="line">        // string == &apos;email=1&apos;</span><br><span class="line">        let parts = string.split(&apos;=&apos;) // [&apos;email&apos;, &apos;1&apos;]</span><br><span class="line">        let key = parts[0]</span><br><span class="line">        let value = parts[1]</span><br><span class="line">        hash[key] = decodeURIComponent(value) // hash[&apos;email&apos;] = &apos;1&apos;</span><br><span class="line">      &#125;)</span><br><span class="line">      let &#123;email, password&#125; = hash</span><br><span class="line">      var users = fs.readFileSync(&apos;./db/users&apos;, &apos;utf8&apos;)</span><br><span class="line">      try&#123;</span><br><span class="line">        users = JSON.parse(users) // []</span><br><span class="line">      &#125;catch(exception)&#123;</span><br><span class="line">        users = []</span><br><span class="line">      &#125;</span><br><span class="line">      let found</span><br><span class="line">      for(let i=0;i&lt;users.length; i++)&#123;</span><br><span class="line">        if(users[i].email === email &amp;&amp; users[i].password === password)&#123;</span><br><span class="line">          found = true</span><br><span class="line">          break</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      if(found)&#123;</span><br><span class="line">        response.setHeader(&apos;Set-Cookie&apos;, `sign_in_email=$&#123;email&#125;`)</span><br><span class="line">        response.statusCode = 200</span><br><span class="line">      &#125;else&#123;</span><br><span class="line">        response.statusCode = 401</span><br><span class="line">      &#125;</span><br><span class="line">      response.end()</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;else if(path===&apos;/main.js&apos;)&#123;</span><br><span class="line">    let string = fs.readFileSync(&apos;./main.js&apos;, &apos;utf8&apos;)</span><br><span class="line">    response.statusCode = 200</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/javascript;charset=utf-8&apos;)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    response.statusCode = 404</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/html;charset=utf-8&apos;)</span><br><span class="line">    response.write(`</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;error&quot;: &quot;not found&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    `)</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /******** 代码结束，下面不要看 ************/</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">function readBody(request)&#123;</span><br><span class="line">  return new Promise((resolve, reject)=&gt;&#123;</span><br><span class="line">    let body = []</span><br><span class="line">    request.on(&apos;data&apos;, (chunk) =&gt; &#123;</span><br><span class="line">      body.push(chunk);</span><br><span class="line">    &#125;).on(&apos;end&apos;, () =&gt; &#123;</span><br><span class="line">      body = Buffer.concat(body).toString();</span><br><span class="line">      resolve(body)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server.listen(port)</span><br><span class="line">console.log(&apos;监听 &apos; + port + &apos; 成功\n请打开 http://localhost:&apos; + port)</span><br></pre></td></tr></table></figure>
<h2 id="sign-up"><a href="#sign-up" class="headerlink" title="sign_up"></a>sign_up</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;form-wrapper&quot;&gt;</span><br><span class="line">    &lt;h1&gt;注册&lt;/h1&gt;</span><br><span class="line">    &lt;form id=&quot;signUpForm&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;label&gt;邮箱&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;error&quot;&gt;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;label&gt;密码&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;error&quot;&gt;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;label&gt;确认密码&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password_confirmation&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;error&quot;&gt;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;注册&quot;&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    let $form = $(&apos;#signUpForm&apos;)</span><br><span class="line">    $form.on(&apos;submit&apos;, (e)=&gt;&#123;</span><br><span class="line">      e.preventDefault()</span><br><span class="line">      let hash = &#123;&#125;</span><br><span class="line">      let need = [&apos;email&apos;, &apos;password&apos;, &apos;password_confirmation&apos;]</span><br><span class="line">      need.forEach((name)=&gt;&#123;</span><br><span class="line">        let value = $form.find(`[name=$&#123;name&#125;]`).val()</span><br><span class="line">        hash[name] = value</span><br><span class="line">      &#125;)</span><br><span class="line">      $form.find(&apos;.error&apos;).each((index, span)=&gt;&#123;</span><br><span class="line">        $(span).text(&apos;&apos;)</span><br><span class="line">      &#125;)</span><br><span class="line">      if(hash[&apos;email&apos;] === &apos;&apos;)&#123;</span><br><span class="line">        $form.find(&apos;[name=&quot;email&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">          .text(&apos;填邮箱呀同学&apos;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      if(hash[&apos;password&apos;] === &apos;&apos;)&#123;</span><br><span class="line">        $form.find(&apos;[name=&quot;password&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">          .text(&apos;填密码呀同学&apos;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      if(hash[&apos;password_confirmation&apos;] === &apos;&apos;)&#123;</span><br><span class="line">        $form.find(&apos;[name=&quot;password_confirmation&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">          .text(&apos;确认密码呀同学&apos;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      if(hash[&apos;password&apos;] !== hash[&apos;password_confirmation&apos;])&#123;</span><br><span class="line">        $form.find(&apos;[name=&quot;password_confirmation&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">          .text(&apos;密码不匹配&apos;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      $.post(&apos;/sign_up&apos;, hash)  </span><br><span class="line">        .then((response)=&gt;&#123;</span><br><span class="line">          console.log(response)</span><br><span class="line">        &#125;, (request)=&gt;&#123;</span><br><span class="line">          let &#123;errors&#125; = request.responseJSON</span><br><span class="line">          if(errors.email &amp;&amp; errors.email === &apos;invalid&apos;)&#123;</span><br><span class="line">            $form.find(&apos;[name=&quot;email&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">              .text(&apos;邮箱格式错误&apos;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h2 id="sign-in"><a href="#sign-in" class="headerlink" title="sign_in"></a>sign_in</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div class=&quot;form-wrapper&quot;&gt;</span><br><span class="line">    &lt;h1&gt;登录&lt;/h1&gt;</span><br><span class="line">    &lt;form id=&quot;signInForm&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;label&gt;邮箱&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;email&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;error&quot;&gt;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;label&gt;密码&lt;/label&gt;</span><br><span class="line">        &lt;input type=&quot;password&quot; name=&quot;password&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;error&quot;&gt;&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;row&quot;&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;登录&quot;&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;script src=&quot;https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    let $form = $(&apos;#signInForm&apos;)</span><br><span class="line">    $form.on(&apos;submit&apos;, (e)=&gt;&#123; </span><br><span class="line">      e.preventDefault()  </span><br><span class="line">      let hash = &#123;&#125;  </span><br><span class="line">      let need = [&apos;email&apos;, &apos;password&apos;]</span><br><span class="line">      need.forEach((name)=&gt;&#123;</span><br><span class="line">        let value = $form.find(`[name=$&#123;name&#125;]`).val()</span><br><span class="line">        hash[name] = value</span><br><span class="line">      &#125;)</span><br><span class="line">      $form.find(&apos;.error&apos;).each((index, span)=&gt;&#123;</span><br><span class="line">        $(span).text(&apos;&apos;)</span><br><span class="line">      &#125;)</span><br><span class="line">      if(hash[&apos;email&apos;] === &apos;&apos;)&#123;</span><br><span class="line">        $form.find(&apos;[name=&quot;email&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">          .text(&apos;填邮箱呀同学&apos;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      if(hash[&apos;password&apos;] === &apos;&apos;)&#123;</span><br><span class="line">        $form.find(&apos;[name=&quot;password&quot;]&apos;).siblings(&apos;.error&apos;)</span><br><span class="line">          .text(&apos;填密码呀同学&apos;)</span><br><span class="line">        return</span><br><span class="line">      &#125;</span><br><span class="line">      $.post(&apos;/sign_in&apos;, hash)  </span><br><span class="line">        .then((response)=&gt;&#123;</span><br><span class="line">          window.location.href = &apos;/&apos;</span><br><span class="line">        &#125;, (request)=&gt;&#123;</span><br><span class="line">          alert(&apos;邮箱与密码不匹配&apos;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
<h2 id="index-html"><a href="#index-html" class="headerlink" title="index.html"></a>index.html</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;h1&gt;你的密码是：__password__&lt;/h1&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/18/CSS深入浅出总结/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/18/CSS深入浅出总结/" itemprop="url">CSS深入浅出总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-18T16:50:45+08:00">
                2019-01-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="CSS-的学习思路"><a href="#CSS-的学习思路" class="headerlink" title="CSS 的学习思路"></a>CSS 的学习思路</h1><p>理解常用原理，熟练常用套路。</p>
<ul>
<li>控制文档流：利用好默认的宽度和高度规则</li>
<li>控制 z-index：堆叠上下文和堆叠顺序</li>
<li>理解 BFC</li>
<li>理解 IFC</li>
<li>理解 Float 布局和 Flex 布局</li>
<li>理解响应式</li>
<li>掌握动态 REM 方案</li>
<li>掌握 icon 的使用</li>
<li>掌握 Bootstrap 的使用</li>
<li>其他套路收集</li>
</ul>
<p>别人研究出来我直接用即可。</p>
<p><a href="https://daneden.github.io/animate.css/" target="_blank" rel="noopener">animate.css</a>
<a href="https://css-tricks.com/" target="_blank" rel="noopener">CSS tricks</a>
<a href="https://codepen.io/pens/" target="_blank" rel="noopener">Codepen</a>
<a href="https://tympanus.net/codrops/" target="_blank" rel="noopener">Codrops</a>
<a href="https://itmeo.com/" target="_blank" rel="noopener">itmeo</a></p>
<h1 id="控制文档流：利用好默认的宽度和高度规则"><a href="#控制文档流：利用好默认的宽度和高度规则" class="headerlink" title="控制文档流：利用好默认的宽度和高度规则"></a>控制文档流：利用好默认的宽度和高度规则</h1><ul>
<li>文档流中内联元素默认从左到右排列，宽度不够则自动换行</li>
<li>文档流中块级元素从上到下排列，每个元素占一行</li>
<li>float:left、position:absolute、position: fixed 可以使元素脱离文档流</li>
<li>块级元素的高度由其文档流中元素高度的总和确定</li>
<li>给 inline 元素设置宽高是没有任何效果的</li>
<li>height 可以用 line-height 和 padding 来撑，这样写更灵活美观</li>
</ul>
<p>两行文字「姓名」与「联系方式」两端对齐套路
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.span&#123;</span><br><span class="line">    display:inline-block;</span><br><span class="line">    width:4em;</span><br><span class="line">    text-align:justify;</span><br><span class="line">    overflow:hidden;</span><br><span class="line">&#125;</span><br><span class="line">.span::after&#123;</span><br><span class="line">    content:&quot;&quot;;</span><br><span class="line">    display:inline-block;</span><br><span class="line">    width:100%;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>多行(3)文本超出部分变成省略号的套路
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$&#123;</span><br><span class="line">    overflow: hidden;  </span><br><span class="line">    text-overflow: ellipsis;  </span><br><span class="line">    display: -webkit-box;  </span><br><span class="line">    -webkit-line-clamp: 3;  </span><br><span class="line">    -webkit-box-orient: vertical; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="控制-z-index：堆叠上下文和堆叠顺序"><a href="#控制-z-index：堆叠上下文和堆叠顺序" class="headerlink" title="控制 z-index：堆叠上下文和堆叠顺序"></a>控制 z-index：堆叠上下文和堆叠顺序</h1><p><a href="https://www.zhangxinxu.com/wordpress/2016/01/understand-css-stacking-context-order-z-index/" target="_blank" rel="noopener">堆叠上下文</a></p>
<p>堆叠顺序</p>
<ul>
<li>z-index: -</li>
<li>background</li>
<li>border</li>
<li>块级</li>
<li>浮动</li>
<li>内联</li>
<li>z-index: 0</li>
<li>z-index: +</li>
<li>如果是兄弟元素重叠，那么后面的盖在前面的身上。</li>
</ul>
<p>堆叠作用域,跟 BFC 一样,如下属性会触发堆叠上下文</p>
<ul>
<li>根元素 (HTML),</li>
<li>z-index 值不为 “auto”的 绝对/相对定位，</li>
<li>一个 z-index 值不为 “auto”的 flex 项目 (flex item)，即：父元素 display: flex|inline-flex，</li>
<li>opacity 属性值小于 1 的元素（参考 the specification for opacity），</li>
<li>transform 属性值不为 “none”的元素，</li>
<li>mix-blend-mode 属性值不为 “normal”的元素，</li>
<li>filter值不为“none”的元素，</li>
<li>perspective值不为“none”的元素，</li>
<li>isolation 属性被设置为 “isolate”的元素，</li>
<li>position: fixed</li>
<li>在 will-change 中指定了任意 CSS 属性，即便你没有直接指定这些属性的值</li>
<li>-webkit-overflow-scrolling 属性被设置 “touch”的元素</li>
</ul>
<h1 id="理解-BFC"><a href="#理解-BFC" class="headerlink" title="理解 BFC"></a>理解 BFC</h1><p>一个块格式化上下文（block formatting context） 是Web页面的可视化CSS渲染出的一部分。它是块级盒布局出现的区域，也是浮动层元素进行交互的区域。</p>
<p>一个块格式化上下文由以下之一创建：</p>
<ul>
<li>根元素或其它包含它的元素</li>
<li>浮动元素 (元素的 float 不是 none)</li>
<li>绝对定位元素 (元素具有 position 为 absolute 或 fixed)</li>
<li>内联块 (元素具有 display: inline-block)</li>
<li>表格单元格 (元素具有 display: table-cell，HTML表格单元格默认属性)</li>
<li>表格标题 (元素具有 display: table-caption, HTML表格标题默认属性)</li>
<li>具有overflow 且值不是 visible 的块元素，</li>
<li>display: flow-root</li>
<li>column-span: all 应当总是会创建一个新的格式化上下文，即便具有 column-span: all 的元素并不被包裹在一个多列容器中。
一个块格式化上下文包括创建它的元素内部所有内容，除了被包含于创建新的块级格式化上下文的后代元素内的元素。</li>
</ul>
<p>BFC的作用：</p>
<ol>
<li>父元素管子元素：用 BFC 包住浮动元素。</li>
<li>兄弟元素划清界限：用 float + div 做左右自适应布局。</li>
</ol>
<p>避免其他bug的触发BFC套路：<code>display: flow-root; /*触发BFC*/</code></p>
<h1 id="理解-IFC"><a href="#理解-IFC" class="headerlink" title="理解 IFC"></a>理解 IFC</h1><p>IFC(inline formatting context)规则：在行内格式化上下文中，框(boxes)一个接一个地水平排列，起点是包含块的顶部。水平方向上的 margin，border 和 padding在框之间得到保留。框在垂直方向上可以以不同的方式对齐：它们的顶部或底部对齐，或根据其中文字的基线对齐。包含那些框的长方形区域，会形成一行，叫做行框。</p>
<p><a href="https://zhuanlan.zhihu.com/p/25808995" target="_blank" rel="noopener">《深入理解 CSS：字体度量、line-height 和 vertical-align》</a></p>
<p>IFC应用：</p>
<ul>
<li>图片下面有空隙
  vertical-align: top
  img{display: block;}
  font-size: 0 不建议，bug多</li>
<li>inline-block 元素对不齐 ： 用 flex 或 float</li>
<li>inline-block 有空隙 ： flex 或 float</li>
</ul>
<h1 id="理解-Float-布局和-Flex-布局"><a href="#理解-Float-布局和-Flex-布局" class="headerlink" title="理解 Float 布局和 Flex 布局"></a>理解 Float 布局和 Flex 布局</h1><ul>
<li>不到万不得已，不要写死 width 和 height</li>
<li>尽量用高级语法，如 calc、flex</li>
<li>如果是 IE，就全部写死</li>
</ul>
<p><a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener">Flex 布局教程</a>
如果宽度不够，可以用 margin: 0 -4px;</p>
<p>float布局父元素加clearfix
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">.clearfix:after&#123;</span><br><span class="line">    content: &apos;&apos;;</span><br><span class="line">    display: block;</span><br><span class="line">    clear: both;</span><br><span class="line">&#125;</span><br><span class="line">.clearfix&#123;</span><br><span class="line">    zoom: 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="理解响应式"><a href="#理解响应式" class="headerlink" title="理解响应式"></a>理解响应式</h1><p>手机端页面的做法:</p>
<ul>
<li>media query</li>
<li>先确保设计图，后写代码</li>
<li>隐藏元素</li>
<li>手机端要加一个 meta<code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0&quot;&gt;</code></li>
</ul>
<p>手机端的交互方式不一样</p>
<ul>
<li>没有 hover</li>
<li>有 touch 事件</li>
<li>没有 resize</li>
<li>没有滚动条</li>
</ul>
<h1 id="掌握动态-REM-方案"><a href="#掌握动态-REM-方案" class="headerlink" title="掌握动态 REM 方案"></a>掌握动态 REM 方案</h1><ol>
<li><p>手机端方案的特点</p>
<ul>
<li>所有手机显示的界面都是一样的，只是大小不同</li>
<li>1 rem == html font-size == viewport width</li>
</ul>
</li>
<li><p>使用 JS 动态调整 REM</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    var pageWidth = window.innerWidth</span><br><span class="line">    document.write(&apos;&lt;style&gt;html&#123;font-size:&apos;+pageWidth+&apos;px;&#125;&lt;/style&gt;&apos;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>REM 可以与其他单位同时存在</p>
</li>
<li><p>在 SCSS 里使用 PX2REM</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mkdir ~/Desktop/scss-demo</span><br><span class="line">cd ~/Desktop/scss-demo</span><br><span class="line">mkdir scss css</span><br><span class="line">touch scss/style.scss</span><br><span class="line">start scss/style.scss</span><br><span class="line">node-sass -wr scss -o css</span><br></pre></td></tr></table></figure>
<p> 编辑 scss 文件就会自动得到 css 文件
 在 scss 文件里添加</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@function px( $px )&#123;</span><br><span class="line">  @return $px/$designWidth*10 + rem;</span><br><span class="line">&#125;</span><br><span class="line">$designWidth : 640; // 640 是设计稿的宽度，你要根据设计稿的宽度填写。</span><br><span class="line">.child&#123;</span><br><span class="line">  width: px(320);</span><br><span class="line">  height: px(160);</span><br><span class="line">  margin: px(40) px(40);</span><br><span class="line">  border: 1px solid red;</span><br><span class="line">  float: left;</span><br><span class="line">  font-size: 1.2em;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 即可实现 px 自动变 rem</p>
</li>
</ol>
<h1 id="掌握-icon-的使用"><a href="#掌握-icon-的使用" class="headerlink" title="掌握 icon 的使用"></a>掌握 icon 的使用</h1><p><a href="https://www.iconfont.cn/" target="_blank" rel="noopener">使用SVG</a>
第一步：拷贝项目下面生成的symbol代码：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">//at.alicdn.com/t/font_8d5l8fzk5b87iudi.js</span><br></pre></td></tr></table></figure></p>
<p>第二步：加入通用css代码（引入一次就行）：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;style type=&quot;text/css&quot;&gt;</span><br><span class="line">    .icon &#123;</span><br><span class="line">       width: 1em; height: 1em;</span><br><span class="line">       vertical-align: -0.15em;</span><br><span class="line">       fill: currentColor;</span><br><span class="line">       overflow: hidden;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure></p>
<p>第三步：挑选相应图标并获取类名，应用于页面：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg class=&quot;icon&quot; aria-hidden=&quot;true&quot;&gt;</span><br><span class="line">    &lt;use xlink:href=&quot;#icon-xxx&quot;&gt;&lt;/use&gt;</span><br><span class="line">&lt;/svg&gt;</span><br></pre></td></tr></table></figure></p>
<h1 id="掌握-Bootstrap-的使用"><a href="#掌握-Bootstrap-的使用" class="headerlink" title="掌握 Bootstrap 的使用"></a>掌握 Bootstrap 的使用</h1><p>Bootstrap 的使用方法就是复制粘贴</p>
<h1 id="其他套路收集"><a href="#其他套路收集" class="headerlink" title="其他套路收集"></a>其他套路收集</h1><p>磨砂效果思路：底部色彩用background-color，白噪声采用png图片作为background-image。优化一下，采用base64方式设background-image。
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">  background-color: #000000;</span><br><span class="line">  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAUVBMVEWFhYWDg4N3d3dtbW17e3t1dXWBgYGHh4d5eXlzc3OLi4ubm5uVlZWPj4+NjY19fX2JiYl/f39ra2uRkZGZmZlpaWmXl5dvb29xcXGTk5NnZ2c8TV1mAAAAG3RSTlNAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAvEOwtAAAFVklEQVR4XpWWB67c2BUFb3g557T/hRo9/WUMZHlgr4Bg8Z4qQgQJlHI4A8SzFVrapvmTF9O7dmYRFZ60YiBhJRCgh1FYhiLAmdvX0CzTOpNE77ME0Zty/nWWzchDtiqrmQDeuv3powQ5ta2eN0FY0InkqDD73lT9c9lEzwUNqgFHs9VQce3TVClFCQrSTfOiYkVJQBmpbq2L6iZavPnAPcoU0dSw0SUTqz/GtrGuXfbyyBniKykOWQWGqwwMA7QiYAxi+IlPdqo+hYHnUt5ZPfnsHJyNiDtnpJyayNBkF6cWoYGAMY92U2hXHF/C1M8uP/ZtYdiuj26UdAdQQSXQErwSOMzt/XWRWAz5GuSBIkwG1H3FabJ2OsUOUhGC6tK4EMtJO0ttC6IBD3kM0ve0tJwMdSfjZo+EEISaeTr9P3wYrGjXqyC1krcKdhMpxEnt5JetoulscpyzhXN5FRpuPHvbeQaKxFAEB6EN+cYN6xD7RYGpXpNndMmZgM5Dcs3YSNFDHUo2LGfZuukSWyUYirJAdYbF3MfqEKmjM+I2EfhA94iG3L7uKrR+GdWD73ydlIB+6hgref1QTlmgmbM3/LeX5GI1Ux1RWpgxpLuZ2+I+IjzZ8wqE4nilvQdkUdfhzI5QDWy+kw5Wgg2pGpeEVeCCA7b85BO3F9DzxB3cdqvBzWcmzbyMiqhzuYqtHRVG2y4x+KOlnyqla8AoWWpuBoYRxzXrfKuILl6SfiWCbjxoZJUaCBj1CjH7GIaDbc9kqBY3W/Rgjda1iqQcOJu2WW+76pZC9QG7M00dffe9hNnseupFL53r8F7YHSwJWUKP2q+k7RdsxyOB11n0xtOvnW4irMMFNV4H0uqwS5ExsmP9AxbDTc9JwgneAT5vTiUSm1E7BSflSt3bfa1tv8Di3R8n3Af7MNWzs49hmauE2wP+ttrq+AsWpFG2awvsuOqbipWHgtuvuaAE+A1Z/7gC9hesnr+7wqCwG8c5yAg3AL1fm8T9AZtp/bbJGwl1pNrE7RuOX7PeMRUERVaPpEs+yqeoSmuOlokqw49pgomjLeh7icHNlG19yjs6XXOMedYm5xH2YxpV2tc0Ro2jJfxC50ApuxGob7lMsxfTbeUv07TyYxpeLucEH1gNd4IKH2LAg5TdVhlCafZvpskfncCfx8pOhJzd76bJWeYFnFciwcYfubRc12Ip/ppIhA1/mSZ/RxjFDrJC5xifFjJpY2Xl5zXdguFqYyTR1zSp1Y9p+tktDYYSNflcxI0iyO4TPBdlRcpeqjK/piF5bklq77VSEaA+z8qmJTFzIWiitbnzR794USKBUaT0NTEsVjZqLaFVqJoPN9ODG70IPbfBHKK+/q/AWR0tJzYHRULOa4MP+W/HfGadZUbfw177G7j/OGbIs8TahLyynl4X4RinF793Oz+BU0saXtUHrVBFT/DnA3ctNPoGbs4hRIjTok8i+algT1lTHi4SxFvONKNrgQFAq2/gFnWMXgwffgYMJpiKYkmW3tTg3ZQ9Jq+f8XN+A5eeUKHWvJWJ2sgJ1Sop+wwhqFVijqWaJhwtD8MNlSBeWNNWTa5Z5kPZw5+LbVT99wqTdx29lMUH4OIG/D86ruKEauBjvH5xy6um/Sfj7ei6UUVk4AIl3MyD4MSSTOFgSwsH/QJWaQ5as7ZcmgBZkzjjU1UrQ74ci1gWBCSGHtuV1H2mhSnO3Wp/3fEV5a+4wz//6qy8JxjZsmxxy5+4w9CDNJY09T072iKG0EnOS0arEYgXqYnXcYHwjTtUNAcMelOd4xpkoqiTYICWFq0JSiPfPDQdnt+4/wuqcXY47QILbgAAAABJRU5ErkJggg==); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://segmentfault.com/q/1010000007793299" target="_blank" rel="noopener">参考资料</a></p>
<p>磨砂玻璃效果:
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">body, main::before &#123; </span><br><span class="line">    background: url(&quot;tiger.jpg&quot;) 0 / cover fixed; </span><br><span class="line">&#125; </span><br><span class="line">main &#123; </span><br><span class="line">    position: relative; </span><br><span class="line">    background: hsla(0,0%,100%,.3); </span><br><span class="line">    overflow: hidden; </span><br><span class="line">&#125; </span><br><span class="line">main::before &#123; </span><br><span class="line">    content: &apos;&apos;; </span><br><span class="line">    position: absolute; </span><br><span class="line">    top: 0; right: 0; bottom: 0; left: 0; </span><br><span class="line">    filter: blur(20px); </span><br><span class="line">    margin: -30px; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><a href="https://www.w3cplus.com/css3/css-secrets/frosted-glass-effect.html" target="_blank" rel="noopener">参考资料</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/01/07/实现一个jQuery的API/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/01/07/实现一个jQuery的API/" itemprop="url">实现一个jQuery的API</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-01-07T20:52:44+08:00">
                2019-01-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">window.jQuery = function (nodeOrSelector) &#123; //接受一个节点或者CSS选择器来找到目标</span><br><span class="line">    let nodes = &#123;&#125; //初始化一个空的nodes对象，来存放获取到的目标对象</span><br><span class="line">    if (typeof nodeOrSelector === &apos;string&apos;) &#123;  //如果接受到的参数是CSS选择器</span><br><span class="line">        let temp = document.querySelectorAll(nodeOrSelector) //通过DOM的querySelectorAll方法来找到目标对象存放到temp中</span><br><span class="line">        for (let i = 0; i &lt; temp.length; i++) &#123; //遍历这个CSS选择器找到的所有目标</span><br><span class="line">            nodes[i] = temp[i] // 将获取的伪数组的每个值一一存放到nodes对象中</span><br><span class="line">        &#125;</span><br><span class="line">        nodes.length = temp.length //将获取到的伪数组的长度值赋给nodes对象的长度</span><br><span class="line">    &#125; else if (nodeOrSelector instanceof Node) &#123; //如果接受到的参数是一个节点</span><br><span class="line">        nodes = &#123; //直接将改节点存放到nodes对象中</span><br><span class="line">            0: nodeOrSelector, //有且仅有一个的值即节点本身</span><br><span class="line">            length: 1 //对象只存了一个节点故长度为1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    nodes.addClass = function (classes) &#123; //设置一个添加类名的函数addClass，可接受多个类名</span><br><span class="line">        classes.forEach(value =&gt; &#123; //多个类名通过数组存放，通过数组的forEach方法遍历类名数组的每一个值。</span><br><span class="line">            for (let i = 0; i &lt; nodes.length; i++) &#123; //遍历获取到的每个节点</span><br><span class="line">                nodes[i].classList.add(value) //将类名数组的每一个值都添加到目标节点的classList中</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    nodes.Text = function (text) &#123; //设置一个获取文本或添加文本的函数Text</span><br><span class="line">        if (text === undefined) &#123; //如果用户没有提供参数，默认为获取目标节点中的文本</span><br><span class="line">            var texts = [] //初始化一个空的数组对象，来存放文本</span><br><span class="line">            for (let i = 0; i &lt; node.length; i++) &#123; //遍历获取到的每个节点</span><br><span class="line">                texts.push(node[i].textContent) //通过DOM的textContent方法来获取节点中的文本，并通过数组的push方法将文本存到texts数组中</span><br><span class="line">            &#125;</span><br><span class="line">            return texts //将存放完文本的texts数组返回给用户</span><br><span class="line">        &#125; else &#123; //如果用户提供了参数，默认为将参数设置为目标节点中的文本</span><br><span class="line">            for (let i = 0; i &lt; nodes.length; i++) &#123; //遍历获取到的每个节点</span><br><span class="line">                nodes[i].textContent = text //通过DOM的textContent方法将用户提供的参数设置为节点中的文本。</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return nodes //返回获取到的节点，提供给客户使用。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/31/原型与原型链/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="eririgasuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Blog for learning">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/31/原型与原型链/" itemprop="url">原型与原型链</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-31T23:03:29+08:00">
                2018-12-31
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="全局对象-window"><a href="#全局对象-window" class="headerlink" title="全局对象 window"></a>全局对象 window</h1><p>ECMAScript 规定全局对象叫做 global，但是浏览器把 window 作为全局对象（浏览器先存在的）
window 就是一个哈希表，有很多属性。
window 的属性就是全局变量。
这些全局变量分为两种：</p>
<ol>
<li>一种是 ECMAScript 规定的</li>
</ol>
<ul>
<li>global.parseInt</li>
<li>global.parseFloat</li>
<li>global.Number</li>
<li>global.String</li>
<li>global.Boolean</li>
<li>global.Object</li>
</ul>
<ol start="2">
<li>一种是浏览器自己加的属性</li>
</ol>
<ul>
<li>window.alert</li>
<li>window.prompt</li>
<li>window.comfirm</li>
<li>window.console.log</li>
<li>window.console.dir</li>
<li>window.document</li>
<li>window.document.createElement</li>
<li>window.document.getElementById</li>
</ul>
<h1 id="全局函数"><a href="#全局函数" class="headerlink" title="全局函数"></a>全局函数</h1><ol>
<li>Number
var n = new Number(1) 创建一个 Number 对象
1 与 new Number(1) 的区别是什么？基本对象在stack里，new出来的对象在heap里。</li>
<li>String
var s = new String(‘hello’) 创建一个 String 对象
‘hello’ 与 new String(‘hello’) 的区别是什么？基本对象在stack里，new出来的对象在heap里。</li>
<li>Boolean
var b = new Boolean(true) 创建一个 Boolean 对象
true 与 new Boolean(true) 的区别是什么？基本对象在stack里，new出来的对象在heap里。</li>
<li>Object
var o1 = {}
var o2 = new Object()
o1 和 o2 没区别</li>
</ol>
<h1 id="公用的属性藏在哪"><a href="#公用的属性藏在哪" class="headerlink" title="公用的属性藏在哪"></a>公用的属性藏在哪</h1><p>所有对象都有 toString 和 valueOf 属性，那么我们是否有必要给每个对象一个 toString 和 valueOf 呢？</p>
<p>明显不需要。</p>
<p>JS 的做法是把 toString 和 valueOf 放在一个对象里（暂且叫做公用属性组成的对象）</p>
<p>然后让每一个对象的 <code>__proto__</code> 存储这个「公用属性组成的对象」的地址。</p>
<h1 id="重要公式"><a href="#重要公式" class="headerlink" title="重要公式"></a>重要公式</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">var 对象 = new 函数()</span><br><span class="line">对象.__proto__ === 对象的构造函数.prototype</span><br><span class="line"></span><br><span class="line">// 推论</span><br><span class="line">var number = new Number()</span><br><span class="line">number.__proto__ = Number.prototype</span><br><span class="line">Number.__proto__ = Function.prototype // 因为 Number 是 Function 的实例</span><br><span class="line"></span><br><span class="line">var object = new Object()</span><br><span class="line">object.__proto__ = Object.prototype</span><br><span class="line">Object.__proto__ = Function.prototype // 因为 Object 是 Function 的实例</span><br><span class="line"></span><br><span class="line">var function = new Function()</span><br><span class="line">function.__proto__ = Function.prototype</span><br><span class="line">Function.__proto__ == Function.prototye // 因为 Function 是 Function 的实例！</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2018/12/31/5c2a32eecd55e.jpg" alt="proto.jpg"></p>
<h1 id="其他参考"><a href="#其他参考" class="headerlink" title="其他参考"></a>其他参考</h1><p><a href="https://www.cnblogs.com/thonrt/p/5900510.html" target="_blank" rel="noopener">js深入理解构造函数和原型对象</a>
<img src="https://i.loli.net/2018/12/31/5c2a32ee91e53.png" alt="prototype.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">eririgasuki</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">17</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">eririgasuki</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
